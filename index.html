<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Precios - Comercializadora Futur Green</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- LIBRERÍAS PARA GENERAR PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .whatsapp-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 50;
        }
        /* Estilo para que el botón de descarga no se imprima en el PDF */
        @media print {
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Contenedor principal que será convertido a PDF -->
    <div id="cotizacion-container" class="container mx-auto p-4 sm:p-8 max-w-4xl bg-white sm:shadow-lg sm:my-8 sm:rounded-lg">

        <!-- ===== ENCABEZADO CON LOGO ===== -->
        <header class="flex justify-between items-center pb-8 border-b border-slate-200">
            <div>
                <h1 class="text-2xl font-bold text-slate-900">Comercializadora Futur Green</h1>
                <p class="text-sm text-slate-500">El futuro es circular</p>
            </div>
            <!-- Asegúrate de subir tu logo a la carpeta 'assets' y nombrarlo 'logo-futur-green.jpg' -->
            <img src="assets/logo-futur-green.jpg" alt="Logo Futur Green" class="h-16">
        </header>

        <main class="mt-8">
            <!-- ===== INFORMACIÓN DE LA COTIZACIÓN Y BOTÓN DE DESCARGA ===== -->
            <section class="mb-8 p-6 bg-slate-50 rounded-lg border border-slate-200">
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                    <div>
                        <h2 class="text-sm font-semibold text-slate-500">CLIENTE</h2>
                        <p id="cliente-nombre" class="text-lg font-bold"></p>
                    </div>
                    <div>
                        <h2 class="text-sm font-semibold text-slate-500">FECHA</h2>
                        <p id="cotizacion-fecha" class="text-lg"></p>
                    </div>
                    <div>
                        <h2 class="text-sm font-semibold text-slate-500">COTIZACIÓN #</h2>
                        <p id="cotizacion-numero" class="text-lg"></p>
                    </div>
                </div>
                 <!-- ===== NUEVO BOTÓN DE DESCARGA ===== -->
                <div class="mt-6 text-center no-print">
                    <button onclick="descargarPDF()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg transition-transform transform hover:scale-105">
                        Descargar Cotización (PDF)
                    </button>
                </div>
            </section>
            
            <!-- ===== TABLA DE PRECIOS ===== -->
            <section class="overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th scope="col" class="px-6 py-3">Producto</th>
                                <th scope="col" class="px-6 py-3">Tamaño</th>
                                <th scope="col" class="px-6 py-3">Empaque</th>
                                <th scope="col" class="px-6 py-3 text-right">Precio x Und</th>
                                <th scope="col" class="px-6 py-3 text-right">Precio x Paca</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-productos">
                            <!-- Filas generadas por JS -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <!-- ===== PIE DE PÁGINA ===== -->
        <footer class="text-center mt-12 pt-8 border-t border-slate-200">
            <p class="font-bold">Comercializadora Futur Green — Catálogo de Precios</p>
            <p class="text-sm text-slate-500" id="footer-contacto"></p>
            <p class="text-sm text-slate-500">Cali, Colombia</p>
        </footer>
    </div>

    <!-- ===== BOTÓN FLOTANTE DE WHATSAPP (no se imprime) ===== -->
    <a id="whatsapp-link" href="#" target="_blank" rel="noopener" class="whatsapp-fab bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-full shadow-lg flex items-center gap-2 transition-transform transform hover:scale-105 no-print">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.487 5.235 3.487 8.413 0 6.557-5.338 11.892-11.894 11.892-1.99 0-3.903-.52-5.687-1.475L.057 24zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.655 4.398 1.803 6.243l-.499 1.804 1.807-.497z"/></svg>
        <span>Cotiza aquí</span>
    </a>

    <script>
        // ===================================================================
        // ===== SECCIÓN DE CONFIGURACIÓN (ÚNICO LUGAR PARA MODIFICAR) =====
        // ===================================================================
        const config = {
            cliente: "Ferreteria Shop Cali",
            fecha: "09/09/2025",
            cotizacion: "001",
            whatsapp: "573187514195",
            productos: [
           [
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-15",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 1900,
    "precioPaca": 1900000
  },
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-19",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 2250,
    "precioPaca": 2250000
  },
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-20",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 2730,
    "precioPaca": 2730000
  },
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-25",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 4000,
    "precioPaca": 4000000
  },
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-30",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 5500,
    "precioPaca": 5500000
  },
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-40",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 9500,
    "precioPaca": 9500000
  },
  {
    "producto": "Bolsa Manigueta",
    "tamano": "T-50",
    "Marca": "Americana",
    "empaque": "Paq x1000",
    "precioUnd": 13000,
    "precioPaca": 13000000
  }
]     
        };
        // ===================================================================
        // ===== FIN DE LA SECCIÓN DE CONFIGURACIÓN =====
        // ===================================================================

        const { jsPDF } = window.jspdf;

        function descargarPDF() {
            const cotizacionElement = document.getElementById('cotizacion-container');
            const nombreArchivo = `Cotizacion-${config.cotizacion}-${config.cliente.replace(/ /g, '_')}.pdf`;
            
            // Ocultar botones antes de la captura
            const botones = document.querySelectorAll('.no-print');
            botones.forEach(btn => btn.style.display = 'none');

            html2canvas(cotizacionElement, {
                scale: 2, 
                useCORS: true 
            }).then(canvas => {
                // Volver a mostrar botones después de la captura
                botones.forEach(btn => btn.style.display = '');

                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({
                    orientation: 'p',
                    unit: 'mm',
                    format: 'a4'
                });

                const pdfWidth = pdf.internal.pageSize.getWidth();
                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                const canvasAspectRatio = canvasWidth / canvasHeight;
                
                const finalWidth = pdfWidth;
                const finalHeight = finalWidth / canvasAspectRatio;

                pdf.addImage(imgData, 'PNG', 0, 0, finalWidth, finalHeight);
                pdf.save(nombreArchivo);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const currencyFormatter = new Intl.NumberFormat('es-CO', {
                style: 'currency', currency: 'COP', minimumFractionDigits: 0, maximumFractionDigits: 0,
            });
            document.getElementById('cliente-nombre').textContent = config.cliente;
            document.getElementById('cotizacion-fecha').textContent = config.fecha;
            document.getElementById('cotizacion-numero').textContent = config.cotizacion;
            document.getElementById('footer-contacto').textContent = `WhatsApp: (+57) ${config.whatsapp.replace(/(\d{3})(\d{3})(\d{4})/, '$1-$2-$3')}`;
            const whatsappMsg = encodeURIComponent(`Hola, estoy interesado en la cotización #${config.cotizacion} para ${config.cliente}.`);
            document.getElementById('whatsapp-link').href = `https://wa.me/${config.whatsapp}?text=${whatsappMsg}`;
            const tablaBody = document.getElementById('tabla-productos');
            tablaBody.innerHTML = '';
            config.productos.forEach(p => {
                const fila = document.createElement('tr');
                fila.className = 'bg-white border-b border-slate-200 hover:bg-slate-50';
                fila.innerHTML = `
                    <td class="px-6 py-4 font-medium text-slate-900">${p.producto}</td>
                    <td class="px-6 py-4">${p.tamano}</td>
                    <td class="px-6 py-4">${p.empaque}</td>
                    <td class="px-6 py-4 text-right">${currencyFormatter.format(p.precioUnd)}</td>
                    <td class="px-6 py-4 text-right font-bold">${currencyFormatter.format(p.precioPaca)}</td>
                `;
                tablaBody.appendChild(fila);
            });
        });
    </script>
</body>
</html>

